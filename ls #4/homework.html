<meta charset="UTF-8">

<script>
	// #1
    function numToObj (num) {
        let obj = { };

        if (num >= 0 && num < 1000) {
            let numArr = strToArr(num);
            obj.firstDigit = numArr[0];

            if (numArr[1]) {
                obj.secondDigit = numArr[1];
            }

            if (numArr[2]) {
                obj.thirdDigit = numArr[2];
            }

            return consoleObj(obj);
        } else {
            console.log('Вы ввели число, которое не находится в диапазоне от 0...999');

            return obj;
        }
    }

    function strToArr (num) {
        let none = '';
        let strNum = String(num);
        return strNum.split(none);
    }

    function consoleObj(item) {
        if (item.firstDigit && !item.secondDigit) {
            console.log(`Число состоит только из разряда единиц.`);
            console.log(`Единицы: ${item.firstDigit}`);
        } else if (item.secondDigit && !item.thirdDigit) {
            console.log(`Число состоит только из разрядов десятков и единиц.`);
            console.log(`Десятки: ${item.firstDigit}`);
            console.log(`Единицы: ${item.secondDigit}`);
        } else {
            console.log(`Число состоит из разрядов сотен, десятков и единиц.`);
            console.log(`Сотни: ${item.firstDigit}`);
            console.log(`Десятки: ${item.secondDigit}`);
            console.log(`Единицы: ${item.thirdDigit}`);
        }

        return item;
    }

	// #2
    /**
     * Объект с настройками игры.
     * @property {int} rowsCount Количество строк в карте.
     * @property {int} colsCount Количество колонок в карте.
     * @property {int} startPositionX Начальная позиция игрока по X координате.
     * @property {int} startPositionY Начальная позиция игрока по Y координате.
     */
    const settings = {
        rowsCount: 10,
        colsCount: 10,
        startPositionX: 0,
        startPositionY: 0,
    };

    /**
     * Объект игрока, здесь будут все методы и свойства связанные с ним.
     * @property {int} x Позиция по X-координате.
     * @property {int} y Позиция по Y-координате.
     */
    const player = {
        x: null,
        y: null,

        /**
         * Инициализация игрока и его метоположения.
         */
        init(startX, startY) {
            this.x = startX;
            this.y = startY;
        },
        /**
         * Метод, который изменяет позицию игрока на поле.
         * @param point - объект точки, который после проверки передаётся сюда.
         */
        move(point) {
            // Определяем направление и обновляем местоположение игрока в зависимости от направления.
            this.x = point.x;
            this.y = point.y;
        },

        getNextPoint(direction) {
            const nextPosition = {
                x: this.x,
                y: this.y,
            };

            switch (direction) {
                case 1:
                    nextPosition.y++;
                    nextPosition.x--;
                    break;
                case 2:
                    nextPosition.y++;
                    break;
                case 3:
                    nextPosition.y++;
                    nextPosition.x++;
                    break;
                case 4:
                    nextPosition.x--;
                    break;
                case 6:
                    nextPosition.x++;
                    break;
                case 7:
                    nextPosition.y--;
                    nextPosition.x--;
                    break;
                case 8:
                    nextPosition.y--;
                    break;
                case 9:
                    nextPosition.y--;
                    nextPosition.x++;
                    break;
            }

            return nextPosition;
        },
    };

    /**
     * Объект игры, здесь будут все методы и свойства связанные с самой игрой в общем.
     * @property {settings} settings Настройки игры.
     * @property {player} player Игрок, участвующий в игре.
     */
    const game = {
        settings,
        player,

        /**
         * Запускает игру.
         */
        run() {
            // Инициализируем игрока, ставим его начальное местоположение
            this.player.init(this.settings.startPositionX, this.settings.startPositionY);
            // Бесконечный цикл
            while (true) {
                // Отображаем нашу игру.
                this.render();

                // Получаем направление от игрока.
                const direction = this.getDirection();

                // Если игрок сказал что хочет выйти (набрал -1), значит выходим.
                if (direction === -1) {
                    alert('До свидания.');
                    return;
                }

                const nextPoint = this.player.getNextPoint(direction);

                if (this.canPlayerMakeStep(nextPoint)) {
                    this.player.move(nextPoint);
                }

            }
        },

        /**
         * Отображает игру в консоли.
         */
        render() {
            // Сюда запишем все что надо отобразить.
            let map = "";

            // Цикл перебирает все строки, которые надо отобразить.
            for (let row = 0; row < this.settings.rowsCount; row++) {
                // В каждой строке отображаем для каждой колонки (x - клетка, o - игрок).
                for (let col = 0; col < this.settings.colsCount; col++) {
                    // Проверяем, если на данной позиции должен быть и игрок, отображаем игрока, если нет - клетку.
                    if (this.player.y === row && this.player.x === col) {
                        map += 'o ';
                    } else {
                        map += 'x ';
                    }
                }
                // После того как отобразили всю строку делаем переход на следующую строку.
                map += '\n';
            }

            // Чистим консоль.
            console.clear();
            // Выводим все что надо отобразить в игре.
            console.log(map);
        },

        canPlayerMakeStep(nextPoint) {
            if (nextPoint.x >= 0 && nextPoint.x < 10 && nextPoint.y >= 0 && nextPoint.y < 10) {
                return true;
            }
        },

        /**
         * Получает и отдает направление от пользователя.
         * @returns {int} Возвращаем направление, введенное пользователем.
         */
        getDirection() {
            // Доступные значения ввода.
            const availableDirections = [-1, 1, 2, 3, 4, 6, 7, 8, 9];

            while (true) {
                // Получаем от пользователя направление.
                const direction = parseInt(prompt('Введите число, куда вы хотите переместиться, -1 для выхода.'));

                // Если направление не одно из доступных, то сообщаем что надо ввести корректные данные
                // и начинаем новую итерацию.
                if (!availableDirections.includes(direction)) {
                    alert(`Для перемещения необходимо ввести одно из чисел: ${availableDirections.join(', ')}.`);
                    continue;
                }

                // Если пользователь ввел корректное значение - отдаем его.
                return direction;
            }
        },
    };
    
	// #3
    const questions = [
        {
            question: 'Земля - обитаемая планета?',
            variants: {
                'a': 'Да',
                'b': 'Нет',
                'c': 'А что это?',
                'd': 'Марс - обитаемая планета!',
                'e': 'Не знаю',
            },
            rightVar: 'a',
        },
        {
            question: 'Первая по счёту планета от Солнца?',
            variants: {
                'a': 'Юпитер',
                'b': 'Земля',
                'c': 'Меркурий',
                'd': 'Сатурн',
                'e': 'Не знаю',
            },
            rightVar: 'c',
        },
        {
            question: 'Сколько у лютей ног?',
            variants: {
                'a': 'Шесть',
                'b': 'Четыре',
                'c': 'Две',
                'd': 'Ноль',
                'e': 'Не знаю',
            },
            rightVar: 'c',
        },
        {
            question: 'Какой вышел последний iPhone?',
            variants: {
                'a': 'iPhone 11',
                'b': 'iPhone XR',
                'c': 'iPhone 5S',
                'd': 'iPhone 12',
                'e': 'Не знаю',
            },
            rightVar: 'd',
        },
        {
            question: 'Как будет правильно на английском слово "белый"?',
            variants: {
                'a': 'blue',
                'b': 'white',
                'c': 'yellow',
                'd': 'bus',
                'e': 'I dont know :(',
            },
            rightVar: 'b',
        },
    ];

    const game = {
        questions,
        scoreCount: 0,
        questionIndex: 0,

        init() {
            this.scoreCount = 0;
            this.questionIndex = 0;
        },

        run() {
            this.init();

            let first = +prompt('Если хотите начать викторину, введите 1, если нет, то -1.');
            if (first === -1) {
                return alert('Всего доброго!');
            } else {
                this.getQuestions();
            }

        },

        getQuestions() {
            while (true) {
                if (this.questionIndex < 5) {
                    let question = this.questions[this.questionIndex].question;
                    let variants = this.getVariants(this.questionIndex);
                    let userAnswer = prompt(`${question}\n${variants}\n\nПросьба вводить только буквы на английском языке. Если хотите выйти из игры, введите -1.`);

                    if (userAnswer === '-1') {
                        break;
                    }

                    if (this.rightOrNot(userAnswer, this.questionIndex)) {
                        this.questionIndex++;
                    } else {
                        alert('Попробуйте снова. Вы ввели неверный ответ.');
                    }
                } else {
                    alert(`Конец! Вы ответили на ${this.scoreCount} из ${this.questions.length}.`);
                    break;
                }
            }
        },
        getVariants(indexOfQuestion) {
            let str = '';
            for (const key in this.questions[indexOfQuestion].variants) {
                str += `${key}. ${this.questions[indexOfQuestion].variants[key]}\n`
            }

            return str;
        },

        rightOrNot(answer, index) {
            if (answer === 'e') {
                return true;
            } else if (answer === this.questions[index].rightVar) {
                this.scoreCount++;
                return true;
            } else {
                return false;
            }
        },
    }
</script>